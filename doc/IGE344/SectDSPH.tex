\subsection{The {\tt DSPH:} module}

The {\tt DSPH:} module is used to create a delta {\sc macrolib} (type {\tt L\_MACROLIB}) with respect to SPH factor variation.
Derivatives of diffusion coefficient and cross-section information (recovered from the input {\sc macrolib}) are stored in the {\tt STEP} heteroneneous list components
present in the output {\sc macrolib}. One component of the {\tt STEP} heteroneneous list is created for each value of energy group $g$ and for each value of mixture $i$.

\vskip 0.08cm

The calling specifications are:

\begin{DataStructure}{Structure \dstr{DSPH:}}
\dusa{DMACRO} \dusa{OPTIM} \moc{:=} \moc{DSPH:} \dusa{MACRO} \moc{::} \dstr{dsph\_data}
\end{DataStructure}

\goodbreak
\noindent where

\begin{ListeDeDescription}{mmmmmm}

\item[\dusa{DMACRO}] {\tt character*12} name of a {\sc lcm} object (type {\tt L\_MACROLIB}) containing the delta {\sc macrolib}
information. \dusa{DMACRO} is created by the module. A {\tt STEP} heteroneneous list is present in \dusa{DMACRO}.

\item[\dusa{OPTIM}] {\tt character*12} name of a second {\sc lcm} object (type {\tt L\_OPTIMIZE}) created by the module. SPH factors are saved
in the the control variable record {\tt 'VAR-VALUE'} of \dusa{OPTIM} object. Input data defined in Sect.~\ref{sect:dsph_data} is
also saved in \dusa{OPTIM} object.

\item[\dusa{MACRO}] {\tt character*12} name of the {\sc lcm} object (type {\tt L\_MACROLIB}) containing the input {\sc macrolib}.

\item[\dstr{dsph\_data}] structure containing the data to module {\tt DSPH:} (see Sect.~\ref{sect:dsph_data}).

\end{ListeDeDescription}

\vskip 0.2cm

\subsubsection{Data input for module {\tt DSPH:}}\label{sect:dsph_data}

\begin{DataStructure}{Structure \dstr{dsph\_data}}
$[$ \moc{EDIT} \dusa{iprint} $]$ \\
$[~$\moc{SPH} $\{$ \moc{PN} $|$ \moc{SN} $|$ \moc{ALBEDO} $\}~]$ \\
$[$ \moc{GRPMIN} \dusa{ngr1} $]~[$ \moc{GRPMAX} \dusa{ngr2} $]$\\
;
\end{DataStructure}

\noindent where
\begin{ListeDeDescription}{mmmmmm}

\item[\moc{EDIT}] keyword used to set \dusa{iprint}.

\item[\dusa{iprint}] index used to control the printing in module {\tt DSPH:}.

\item[\moc{PN}] keyword to activate the calculation of heterogeneous SPH factors of diffusion, PN or SPN type.

\item[\moc{SN}] keyword to activate the calculation of heterogeneous SPH factors of PIJ, IC, SN or MOC type.
This is the default option.

\item[\moc{ALBEDO}] keyword to activate the calculation of a unique SPH factor assigned to the albedo function
in each energy group.

\item[\moc{GRPMIN}] keyword used to set the first energy group where SPH correction is applied. By default,
the first energy group index is used.

\item[\dusa{ngr1}] minimum energy group index where SPH correction is applied.

\item[\moc{GRPMAX}] keyword used to set the last energy group where SPH correction is applied. By default,
the total number of energy groups in \dusa{MACRO} is used.

\item[\dusa{ngr2}] maximum energy group index where SPH correction is applied.

\end{ListeDeDescription}
\clearpage
