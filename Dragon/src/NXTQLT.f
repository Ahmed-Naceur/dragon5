*DECK NXTQLT
      SUBROUTINE NXTQLT(NDIM  ,ORDRE ,NQUAD ,NBANGL,DQUAD ,
     >                  DANGLT,DDENWT)
*
*-----------------------------------------------------------------------
*
*Purpose:
* To define Sanchez-Mao-Santandrea (Legendre-Trapezoidal)
* quadrature angles.
*
*Copyright:
* Copyright (C) 2005 Ecole Polytechnique de Montreal
* This library is free software; you can redistribute it and/or
* modify it under the terms of the GNU Lesser General Public
* License as published by the Free Software Foundation; either
* version 2.1 of the License, or (at your option) any later version.
*
*Author(s):
* M. Hampartzounian
*
*Parameters: input
* NDIM    number of dimensions for geometry.
* ORDRE   quadrature order.
* NQUAD   number of quadrant (in 3-D) and quarter (in 2-D).
* NBANGL  number of angles.
* DQUAD   relative density of each quadrant.
*
*Parameters: output
* DANGLT  director cosines of angles.
* DDENWT  angular density for each angle.
*
*Reference:
* R. Sanchez, L. Mao, S. Santandrea
* Treatment of boundary conditions in trajectory-based deterministic
* transport methods,
* Nucl. Sci. Eng. 140, 23-50 (2002),
*
*----------
*
      IMPLICIT   NONE
*----
*  Subroutine arguments
*----
      INTEGER          NDIM,ORDRE,NQUAD,NBANGL
      DOUBLE PRECISION DQUAD(NQUAD),DANGLT(NDIM,NQUAD,NBANGL),
     >                 DDENWT(NQUAD,NBANGL)
*----
*  Local parameters
*----
      INTEGER          IOUT
      CHARACTER        NAMSBR*6
      PARAMETER       (IOUT=6,NAMSBR='NXTQLT')
      DOUBLE PRECISION DZERO,DONE,DTWO
      PARAMETER       (DZERO=0.0D0,DONE=1.0D0,DTWO=2.0D0)
*----
*  Functions
*----
      DOUBLE PRECISION XDRCST,PI
*----
*  Local variables
*----
      INTEGER          NBPT,ILEVEL,JLEVEL,NLEVEL,KLEVEL,IPOINT,
     >                 IPT,IROT,IDIR1,IDIR2,IDIR3
      DOUBLE PRECISION ALPHA,XI,ROTXI,COSA,SINA,WGTINV
*----
*  Data
*----
      INTEGER          IS,IA
      DOUBLE PRECISION SYST(2,504)
      SAVE             SYST
*----
*  Order =   4
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA=  1,  4)/
     > 6.9431844202970D-02,3.4785484513745D-01,3.3000947820757D-01,
     > 6.5214515486255D-01,6.6999052179243D-01,6.5214515486255D-01,
     > 9.3056815579703D-01,3.4785484513745D-01/
*----
*  Order =   6
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA=  5, 10)/
     > 3.3765242898420D-02,1.7132449237917D-01,1.6939530676687D-01,
     > 3.6076157304814D-01,3.8069040695840D-01,4.6791393457269D-01,
     > 6.1930959304160D-01,4.6791393457269D-01,8.3060469323313D-01,
     > 3.6076157304814D-01,9.6623475710158D-01,1.7132449237917D-01/
*----
*  Order =   8
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA= 11, 18)/
     > 1.9855071751230D-02,1.0122853629036D-01,1.0166676129319D-01,
     > 2.2238103445338D-01,2.3723379504183D-01,3.1370664587789D-01,
     > 4.0828267875218D-01,3.6268378337836D-01,5.9171732124782D-01,
     > 3.6268378337836D-01,7.6276620495816D-01,3.1370664587789D-01,
     > 8.9833323870681D-01,2.2238103445338D-01,9.8014492824877D-01,
     > 1.0122853629037D-01/
*----
*  Order =  10
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA= 19, 28)/
     > 1.3046735741410D-02,6.6671344308670D-02,6.7468316655510D-02,
     > 1.4945134915058D-01,1.6029521585049D-01,2.1908636251599D-01,
     > 2.8330230293538D-01,2.6926671931000D-01,4.2556283050918D-01,
     > 2.9552422471475D-01,5.7443716949082D-01,2.9552422471475D-01,
     > 7.1669769706462D-01,2.6926671931000D-01,8.3970478414951D-01,
     > 2.1908636251598D-01,9.3253168334449D-01,1.4945134915059D-01,
     > 9.8695326425859D-01,6.6671344308680D-02/
*----
*  Order =  12
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA= 29, 40)/
     > 9.2196828766400D-03,4.7175336386520D-02,4.7941371814760D-02,
     > 1.0693932599530D-01,1.1504866290286D-01,1.6007832854335D-01,
     > 2.0634102285669D-01,2.0316742672306D-01,3.1608425050091D-01,
     > 2.3349253653836D-01,4.3738329574427D-01,2.4914704581340D-01,
     > 5.6261670425573D-01,2.4914704581340D-01,6.8391574949909D-01,
     > 2.3349253653836D-01,7.9365897714331D-01,2.0316742672306D-01,
     > 8.8495133709714D-01,1.6007832854336D-01,9.5205862818525D-01,
     > 1.0693932599531D-01,9.9078031712336D-01,4.7175336386530D-02/
*----
*  Order =  14
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA= 41, 54)/
     > 6.8580956516300D-03,3.5119460331920D-02,3.5782558168140D-02,
     > 8.0158087159560D-02,8.6399342465180D-02,1.2151857068798D-01,
     > 1.5635354759414D-01,1.5720316715816D-01,2.4237568182092D-01,
     > 1.8553839747794D-01,3.4044381553606D-01,2.0519846372130D-01,
     > 4.4597252564633D-01,2.1526385346316D-01,5.5402747435367D-01,
     > 2.1526385346316D-01,6.5955618446394D-01,2.0519846372130D-01,
     > 7.5762431817908D-01,1.8553839747794D-01,8.4364645240586D-01,
     > 1.5720316715820D-01,9.1360065753483D-01,1.2151857068801D-01,
     > 9.6421744183186D-01,8.0158087159640D-02,9.9314190434838D-01,
     > 3.5119460331900D-02/
*----
*  Order =  16
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA= 55, 70)/
     > 5.2995325042800D-03,2.7152459412220D-02,2.7712488463060D-02,
     > 6.2253523938620D-02,6.7184398806490D-02,9.5158511682620D-02,
     > 1.2229779582222D-01,1.2462897125565D-01,1.9106187779878D-01,
     > 1.4959598881651D-01,2.7099161117137D-01,1.6915651939500D-01,
     > 3.5919822461037D-01,1.8260341504492D-01,4.5249374508118D-01,
     > 1.8945061045507D-01,5.4750625491882D-01,1.8945061045507D-01,
     > 6.4080177538963D-01,1.8260341504492D-01,7.2900838882863D-01,
     > 1.6915651939500D-01,8.0893812220122D-01,1.4959598881659D-01,
     > 8.7770220417776D-01,1.2462897125559D-01,9.3281560119355D-01,
     > 9.5158511682330D-02,9.7228751153686D-01,6.2253523938730D-02,
     > 9.9470046749577D-01,2.7152459411960D-02/
*----
*  Order =  18
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA= 71, 88)/
     > 4.2174157887900D-03,2.1616013522700D-02,2.2088025216130D-02,
     > 4.9714548897730D-02,5.3698766749330D-02,7.6425730253100D-02,
     > 9.8147520514900D-02,1.0094204410623D-01,1.5415647846934D-01,
     > 1.2255520671199D-01,2.2011458446318D-01,1.4064291467052D-01,
     > 2.9412441926854D-01,1.5468467512628D-01,3.7405688715425D-01,
     > 1.6427648374583D-01,4.5761249347913D-01,1.6914238296314D-01,
     > 5.4238750652087D-01,1.6914238296314D-01,6.2594311284575D-01,
     > 1.6427648374583D-01,7.0587558073145D-01,1.5468467512629D-01,
     > 7.7988541553686D-01,1.4064291467049D-01,8.4584352153055D-01,
     > 1.2255520671182D-01,9.0185247948523D-01,1.0094204410536D-01,
     > 9.4630123325074D-01,7.6425730253490D-02,9.7791197478354D-01,
     > 4.9714548899820D-02,9.9578258421141D-01,2.1616013521800D-02/
*----
*  Order =  20
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA= 89,108)/
     > 3.4357004104500D-03,1.7614007150210D-02,1.8014036355580D-02,
     > 4.0601429811420D-02,4.3882785876460D-02,6.2672048300040D-02,
     > 8.0441514090900D-02,8.3276741600820D-02,1.2683404676701D-01,
     > 1.0193011980500D-01,1.8197315963847D-01,1.1819453196387D-01,
     > 2.4456649902402D-01,1.3168863844884D-01,3.1314695564238D-01,
     > 1.4209610931841D-01,3.8610707442917D-01,1.4917298647260D-01,
     > 4.6173673943325D-01,1.5275338713073D-01,5.3826326056675D-01,
     > 1.5275338713073D-01,6.1389292557083D-01,1.4917298647260D-01,
     > 6.8685304435761D-01,1.4209610931841D-01,7.5543350097599D-01,
     > 1.3168863844881D-01,8.1802684036147D-01,1.1819453196430D-01,
     > 8.7316595323321D-01,1.0193011980587D-01,9.1955848590857D-01,
     > 8.3276741603440D-02,9.5611721412449D-01,6.2672048299060D-02,
     > 9.8198596364340D-01,4.0601429813730D-02,9.9656429958999D-01,
     > 1.7614007149240D-02/
*----
*  Order =  22
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA=109,130)/
     > 2.8527072492200D-03,1.4627995247010D-02,1.4969751104280D-02,
     > 3.3774901643520D-02,3.6521613885420D-02,5.2293335095080D-02,
     > 6.7093711153550D-02,6.9796468469830D-02,1.0609159700204D-01,
     > 8.5941606188540D-02,1.5275636841161D-01,1.0041414445572D-01,
     > 2.0617979824426D-01,1.1293229607784D-01,2.6532208100729D-01,
     > 1.2325237681093D-01,3.2903208955386D-01,1.3117350478704D-01,
     > 3.9606978665589D-01,1.3654149834601D-01,4.6513036334014D-01,
     > 1.3925187285563D-01,5.3486963665986D-01,1.3925187285563D-01,
     > 6.0393021334411D-01,1.3654149834601D-01,6.7096791044615D-01,
     > 1.3117350478703D-01,7.3467791899263D-01,1.2325237681097D-01,
     > 7.9382020175607D-01,1.1293229607735D-01,8.4724363158736D-01,
     > 1.0041414445407D-01,8.9390840300056D-01,8.5941606200660D-02,
     > 9.3290628884161D-01,6.9796468498780D-02,9.6347838612075D-01,
     > 5.2293335115910D-02,9.8503024889079D-01,3.3774901660990D-02,
     > 9.9714729275256D-01,1.4627995244180D-02/
*----
*  Order =  24
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA=131,154)/
     > 2.4063901291700D-03,1.2341230372000D-02,1.2635721706040D-02,
     > 2.8531388386830D-02,3.0862724302950D-02,4.4277438382250D-02,
     > 5.6792236327600D-02,5.9298585401410D-02,8.9999007068280D-02,
     > 7.3346481049510D-02,1.2993790420103D-01,8.6190161662710D-02,
     > 1.7595317403327D-01,9.7618652078700D-02,2.2728926430427D-01,
     > 1.0744427011825D-01,2.8310324618762D-01,1.1550566805371D-01,
     > 3.4247866015179D-01,1.2167047292779D-01,4.0444056626320D-01,
     > 1.2583745634683D-01,4.6797155356870D-01,1.2793819534675D-01,
     > 5.3202844643130D-01,1.2793819534675D-01,5.9555943373680D-01,
     > 1.2583745634683D-01,6.5752133984820D-01,1.2167047292778D-01,
     > 7.1689675381249D-01,1.1550566805375D-01,7.7271073569499D-01,
     > 1.0744427011862D-01,8.2404682596948D-01,9.7618652078090D-02,
     > 8.7006209579226D-01,8.6190161640980D-02,9.1000099294361D-01,
     > 7.3346481087380D-02,9.4320776365649D-01,5.9298585476300D-02,
     > 9.6913727571292D-01,4.4277438491390D-02,9.8736427828303D-01,
     > 2.8531388441590D-02,9.9759360987450D-01,1.2341230342670D-02/
*----
*  Order =  26
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA=155,180)/
     > 2.0571493979300D-03,1.0551372478230D-02,1.0807277149000D-02,
     > 2.4417851310870D-02,2.6420466420930D-02,3.7962382661490D-02,
     > 4.8681069290240D-02,5.0975824567110D-02,7.7277028398650D-02,
     > 6.3274046733270D-02,1.1180702569448D-01,7.4684149647260D-02,
     > 1.5178636975174D-01,8.5045894374660D-02,1.9665385350063D-01,
     > 9.4213800342660D-02,2.4577964258707D-01,1.0205916109701D-01,
     > 2.9847412243771D-01,1.0847184052832D-01,3.5399758025722D-01,
     > 1.1336181654635D-01,4.1157058982154D-01,1.1666044348530D-01,
     > 4.7038495328534D-01,1.1832141527926D-01,5.2961504671466D-01,
     > 1.1832141527926D-01,5.8842941017846D-01,1.1666044348530D-01,
     > 6.4600241974279D-01,1.1336181654634D-01,7.0152587756224D-01,
     > 1.0847184052835D-01,7.5422035741290D-01,1.0205916109622D-01,
     > 8.0334614650062D-01,9.4213800346540D-02,8.4821363024175D-01,
     > 8.5045894377860D-02,8.8819297432568D-01,7.4684149774490D-02,
     > 9.2272297155629D-01,6.3274046588660D-02,9.5131893078649D-01,
     > 5.0975824901560D-02,9.7357953348182D-01,3.7962383110530D-02,
     > 9.8919272293301D-01,2.4417850952720D-02,9.9794285057080D-01,
     > 1.0551372687430D-02/
*----
*  Order =  28
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA=181,208)/
     > 1.7787507361200D-03,9.1242819013200D-03,9.3484183945100D-03,
     > 2.1132105642860D-02,2.2870358829010D-02,3.2901447004060D-02,
     > 4.2183486909730D-02,4.4272911704630D-02,6.7053739163560D-02,
     > 5.5107356859860D-02,9.7179313984470D-02,6.5272918351540D-02,
     > 1.3219456139385D-01,7.4646216042780D-02,1.7167445276944D-01,
     > 8.3113416845760D-02,2.1513976417981D-01,9.0571744471660D-02,
     > 2.6206288749644D-01,9.6930657986830D-02,3.1187424196090D-01,
     > 1.0211296757971D-01,3.6396918618177D-01,1.0605576592271D-01,
     > 4.1771535893334D-01,1.0871119225830D-01,4.7246035505798D-01,
     > 1.1004701301648D-01,5.2753964494202D-01,1.1004701301648D-01,
     > 5.8228464106666D-01,1.0871119225830D-01,6.3603081381827D-01,
     > 1.0605576592271D-01,6.8812575803855D-01,1.0211296757984D-01,
     > 7.3793711250697D-01,9.6930657986390D-02,7.8486023580895D-01,
     > 9.0571744462330D-02,8.2832554725090D-01,8.3113416907730D-02,
     > 8.6780543859396D-01,7.4646215927060D-02,9.0282068597925D-01,
     > 6.5272917861280D-02,9.3294626095468D-01,5.5107358347670D-02,
     > 9.5781651290842D-01,4.4272916167160D-02,9.7712964134678D-01,
     > 3.2901447900010D-02,9.9065158149766D-01,2.1132105031590D-02,
     > 9.9822124929601D-01,9.1242814013200D-03/
*----
*  Order =  30
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA=209,238)/
     > 1.5532485245000D-03,7.9681492978800D-03,8.1659624471000D-03,
     > 1.8466488024340D-02,1.9989040923200D-02,2.8784730112930D-02,
     > 3.6899994297500D-02,3.8799132805590D-02,5.8719724174400D-02,
     > 4.8402711046290D-02,8.5217120885420D-02,5.7493137284820D-02,
     > 1.1611128380469D-01,6.5974238311800D-02,1.5107475249786D-01,
     > 7.3755972731830D-02,1.8973690854755D-01,8.0755895518740D-02,
     > 2.3168792591022D-01,8.6899787157000D-02,2.7648311524657D-01,
     > 9.2122522243050D-02,3.2364763722693D-01,9.6368737173560D-02,
     > 3.7268153691758D-01,9.9593420586940D-02,4.2306504319566D-01,
     > 1.0176238974840D-01,4.7426407872234D-01,1.0285265289356D-01,
     > 5.2573592127766D-01,1.0285265289356D-01,5.7693495680434D-01,
     > 1.0176238974840D-01,6.2731846308230D-01,9.9593420586970D-02,
     > 6.7635236277442D-01,9.6368737173430D-02,7.2351688474671D-01,
     > 9.2122522241670D-02,7.6831207410653D-01,8.6899787160750D-02,
     > 8.1026309144319D-01,8.0755895596270D-02,8.4892524741249D-01,
     > 7.3755972567420D-02,8.8388871659677D-01,6.5974237557010D-02,
     > 9.1478287810668D-01,5.7493140038600D-02,9.4128027763148D-01,
     > 4.8402719663580D-02,9.6310000325849D-01,3.8799141755710D-02,
     > 9.8001096156050D-01,2.8784735108050D-02,9.9183403580605D-01,
     > 1.8466491093820D-02,9.9844675207088D-01,7.9681463878600D-03/
*----
*  Order =  32
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA=239,268)/
     > 1.3681250584000D-03,7.0188717221400D-03,7.1940901808000D-03,
     > 1.6274246803780D-02,1.7619066947310D-02,2.5391984208800D-02,
     > 3.2546800454970D-02,3.4274064691520D-02,5.1839518680800D-02,
     > 4.2835695461780D-02,7.5316149383150D-02,5.0998194564650D-02,
     > 1.0275811846581D-01,5.8684027928990D-02,1.3390893427120D-01,
     > 6.5822235161410D-02,1.6847786965079D-01,7.2345792029120D-02,
     > 2.0614211967012D-01,7.8193895594530D-02,2.4655004636084D-01,
     > 8.3311924380730D-02,2.8932436162924D-01,8.7652092950870D-02,
     > 3.3406569893521D-01,9.1173878706320D-02,3.8035631886341D-01,
     > 9.3844399079790D-02,4.2776401920908D-01,9.5638720079300D-02,
     > 4.7584616715613D-01,9.6540088514730D-02,5.2415383284387D-01,
     > 9.6540088514730D-02,5.7223598079093D-01,9.5638720079300D-02,
     > 6.1964368113639D-01,9.3844399079810D-02,6.6593430106595D-01,
     > 9.1173878706150D-02,7.1067563837155D-01,8.7652092950640D-02,
     > 7.5344995359973D-01,8.3311924388570D-02,7.9385788056245D-01,
     > 7.8193895612890D-02,8.3152212954376D-01,7.2345792209150D-02,
     > 8.6609106766446D-01,6.5822237766910D-02,8.9724187820340D-01,
     > 5.8684043907040D-02,9.2468385448196D-01,5.0998208741440D-02,
     > 9.4816047921927D-01,4.2835659552840D-02,9.6745319752725D-01,
     > 3.4274011751680D-02,9.8238093897537D-01,2.5392043289540D-02/
      DATA             ((SYST(IS,IA),IS=1,2),IA=269,270)/
     > 9.9280590365448D-01,1.6274238576240D-02,9.9863187744191D-01,
     > 7.0188504222100D-03/
*----
*  Order =  34
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA=271,300)/
     > 1.2138349013000D-03,6.2277307558600D-03,6.3869192516100D-03,
     > 1.4451724561770D-02,1.5644733690910D-02,2.2563235943270D-02,
     > 2.8919877166600D-02,3.0490602921410D-02,4.6094370278800D-02,
     > 3.8167281273000D-02,6.7033168791730D-02,4.5525083917960D-02,
     > 9.1557612404410D-02,5.2507708601320D-02,1.1946770920314D-01,
     > 5.9054059156070D-02,1.5053036746507D-01,6.5111530978600D-02,
     > 1.8448917173306D-01,7.0629380155610D-02,2.2106223578649D-01,
     > 7.5561972048180D-02,2.5994673175191D-01,7.9868445124360D-02,
     > 3.0082036012065D-01,8.3513099547360D-02,3.4334445947741D-01,
     > 8.6465739764320D-02,3.8716665418132D-01,8.8701897834840D-02,
     > 4.3192382137060D-01,9.0203044370650D-02,4.7724508902345D-01,
     > 9.0956740330260D-02,5.2275491097655D-01,9.0956740330260D-02,
     > 5.6807617862940D-01,9.0203044370650D-02,6.1283334581861D-01,
     > 8.8701897834850D-02,6.5665554052315D-01,8.6465739764290D-02,
     > 6.9917963987666D-01,8.3513099548570D-02,7.4005326825732D-01,
     > 7.9868445126930D-02,7.7893776418574D-01,7.5561972061710D-02,
     > 8.1551082835912D-01,7.0629379457120D-02,8.4946963217695D-01,
     > 6.5111531202520D-02,8.8053229218955D-01,5.9054074711360D-02,
     > 9.0844238294494D-01,5.2507705481050D-02,9.3296684365079D-01,
     > 4.5525085513800D-02,9.5390560370112D-01,3.8167592545450D-02/
      DATA             ((SYST(IS,IA),IS=1,2),IA=301,304)/
     > 9.7108016452504D-01,3.0490955690320D-02,9.8435521706864D-01,
     > 2.2563397478200D-02,9.9361311954501D-01,1.4451530325050D-02,
     > 9.9878615097296D-01,6.2277937068700D-03/
*----
*  Order =  36
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA=305,334)/
     > 1.0829067579700D-03,5.5561674764700D-03,5.7117396663200D-03,
     > 1.2926691357470D-02,1.3980178693510D-02,2.0174270127740D-02,
     > 2.5868093384500D-02,2.7303499741840D-02,4.1248694560440D-02,
     > 3.4211392743280D-02,6.0035940483070D-02,4.0876996272730D-02,
     > 8.2076289217610D-02,4.7234439323640D-02,1.0721181826147D-01,
     > 5.3244759709300D-02,1.3525549056623D-01,5.8860097418630D-02,
     > 1.6599933099976D-01,6.4039804677380D-02,1.9921619867238D-01,
     > 6.8745328039500D-02,2.3465984437212D-01,7.2941882378020D-02,
     > 2.7206803238074D-01,7.6598411448030D-02,3.1116372520315D-01,
     > 7.9687828738550D-02,3.5165750254906D-01,8.2187266728070D-02,
     > 3.9324955382024D-01,8.4078218978050D-02,4.3563194809598D-01,
     > 8.5346685739370D-02,4.7849090076315D-01,8.5983275670390D-02,
     > 5.2150909923685D-01,8.5983275670390D-02,5.6436805190401D-01,
     > 8.5346685739370D-02,6.0675044618021D-01,8.4078218978020D-02,
     > 6.4834249744579D-01,8.2187266728640D-02,6.8883627483352D-01,
     > 7.9687828731840D-02,7.2793196743448D-01,7.6598411499530D-02,
     > 7.6534015632428D-01,7.2941882238710D-02,8.0078379930975D-01,
     > 6.8745327516900D-02,8.3400067356633D-01,6.4039803761070D-02,
     > 8.6474450115600D-01,5.8860083925380D-02,8.9278819497455D-01,
     > 5.3244889793900D-02,9.1792368751533D-01,4.7234777207990D-02/
      DATA             ((SYST(IS,IA),IS=1,2),IA=335,340)/
     > 9.3996410914631D-01,4.0876449600600D-02,9.5875120172086D-01,
     > 3.4213563175030D-02,9.7413208045779D-01,2.7302342273080D-02,
     > 9.8601960853527D-01,2.0174283453030D-02,9.9428843111626D-01,
     > 1.2925824456940D-02,9.9891703069473D-01,5.5566718456000D-03/
*----
*  Order =  38
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA=341,370)/
     > 9.8333441339000D-04,5.0468854656500D-03,5.1058481717700D-03,
     > 1.1552522428980D-02,1.2612131316970D-02,1.8215585706410D-02,
     > 2.3231189561830D-02,2.4539013893040D-02,3.7156958802540D-02,
     > 3.0864036728520D-02,5.4054909599560D-02,3.6884309301240D-02,
     > 7.3991329170220D-02,4.2705164437670D-02,9.6724056867560D-02,
     > 4.8226693951550D-02,1.2215851106735D-01,5.3432300845900D-02,
     > 1.5010018315296D-01,5.8280339673470D-02,1.8037291120576D-01,
     > 6.2740931378560D-02,2.1277197798854D-01,6.6783939165420D-02,
     > 2.4708263238329D-01,7.0382504806650D-02,2.8307642139671D-01,
     > 7.3512693597450D-02,3.2051377762467D-01,7.6153663277810D-02,
     > 3.5914559554259D-01,7.8287844700040D-02,3.9871477300792D-01,
     > 7.9901033240430D-02,4.3895798733272D-01,8.0982493770660D-02,
     > 4.7960742604771D-01,8.1525029280390D-02,5.2039257395229D-01,
     > 8.1525029280390D-02,5.6104201266726D-01,8.0982493770660D-02,
     > 6.0128522699314D-01,7.9901033240370D-02,6.4085440444255D-01,
     > 7.8287844701560D-02,6.7948622247722D-01,7.6153663266610D-02,
     > 7.1692357815967D-01,7.3512693677670D-02,7.5291736900970D-01,
     > 7.0382504658540D-02,7.8722801874323D-01,6.6783939331140D-02,
     > 8.1962709413251D-01,6.2740933660550D-02,8.4989981340243D-01,
     > 5.8280343712020D-02,8.7784147565137D-01,5.3432297735040D-02/
      DATA             ((SYST(IS,IA),IS=1,2),IA=371,378)/
     > 9.0327600712907D-01,4.8227830719590D-02,9.2600850044772D-01,
     > 4.2707129785660D-02,9.4594543062232D-01,3.6883986643610D-02,
     > 9.6284250366432D-01,3.0881525256230D-02,9.7676949364984D-01,
     > 2.4532771471320D-02,9.8738719838988D-01,1.8220665394490D-02,
     > 9.9489461473028D-01,1.1556650094680D-02,9.9901650708112D-01,
     > 5.0480587932600D-03/
*----
*  Order =  40
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA=379,408)/
     > 8.4438396773000D-04,4.3415791982100D-03,4.7433504658700D-03,
     > 1.0790955034670D-02,1.1228207956250D-02,1.6252231945380D-02,
     > 2.1170648774260D-02,2.2441559704590D-02,3.3502617823100D-02,
     > 2.7835664062340D-02,4.9001917634790D-02,3.3549469533650D-02,
     > 6.6995203524880D-02,3.8737706303810D-02,8.7704890024170D-02,
     > 4.3893720107290D-02,1.1084267582009D-01,4.8686848283500D-02,
     > 1.3634250098496D-01,5.3230489383970D-02,1.6402121010617D-01,
     > 5.7439109098950D-02,1.9372310228905D-01,6.1306338991240D-02,
     > 2.2526647199449D-01,6.4804006556460D-02,2.5846207409080D-01,
     > 6.7912042829150D-02,2.9311040683116D-01,7.0611648558400D-02,
     > 3.2900295255883D-01,7.2886582168900D-02,3.6592390778598D-01,
     > 7.4723169083110D-02,4.0365120962290D-01,7.6110361899000D-02,
     > 4.4195796466366D-01,7.7039818164300D-02,4.8061379124697D-01,
     > 7.7505947978420D-02,5.1938620875303D-01,7.7505947978420D-02,
     > 5.5804203533634D-01,7.7039818164300D-02,5.9634879037692D-01,
     > 7.6110361899020D-02,6.3407609221112D-01,7.4723169083260D-02,
     > 6.7099704750880D-01,7.2886582161390D-02,7.0688959260854D-01,
     > 7.0611648675350D-02,7.4153792871443D-01,6.7912042607660D-02,
     > 7.7473351810972D-01,6.4804008885300D-02,8.0627692408788D-01,
     > 6.1306352760610D-02,8.3597873460403D-01,5.7439151840670D-02/
      DATA             ((SYST(IS,IA),IS=1,2),IA=409,418)/
     > 8.6365759337389D-01,5.3230290482760D-02,8.8915718658253D-01,
     > 4.8686786345600D-02,9.1229528958732D-01,4.3892524295090D-02,
     > 9.3300459616015D-01,3.8733836200490D-02,9.5099819911142D-01,
     > 3.3539847757640D-02,9.6649758869464D-01,2.7837431154340D-02,
     > 9.7882860559165D-01,2.2455890598010D-02,9.8877301735663D-01,
     > 1.6255733352800D-02,9.9525553201263D-01,1.0792898832200D-02,
     > 9.9915603105220D-01,4.3433310487600D-03/
*----
*  Order =  42
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA=419,448)/
     > 1.1436307923000D-03,7.4186665285700D-03,3.4042259466900D-03,
     > 1.0831832268370D-02,1.1496376931880D-02,1.9947942667490D-02,
     > 1.7955662648690D-02,2.2741693977000D-02,3.1330579337640D-02,
     > 2.6763625138290D-02,4.4032756116860D-02,3.1014207506350D-02,
     > 6.1207239976840D-02,3.5215101677740D-02,7.9779208818870D-02,
     > 4.0214419269220D-02,1.0103507239758D-01,4.4488387736430D-02,
     > 1.2436340070041D-01,4.8802057832060D-02,1.4974623669676D-01,
     > 5.2739442801020D-02,1.7706313243465D-01,5.6428613653020D-02,
     > 2.0612502181083D-01,5.9797538031390D-02,2.3680331784740D-01,
     > 6.2843794751680D-02,2.6891361931961D-01,6.5545557530370D-02,
     > 3.0228819052088D-01,6.7889718324440D-02,3.3674191483102D-01,
     > 6.9862990142650D-02,3.7208746313458D-01,7.1454714485220D-02,
     > 4.0813159656596D-01,7.2656175235390D-02,4.4467748639631D-01,
     > 7.3460813453490D-02,4.8152552841733D-01,7.3864234232170D-02,
     > 5.1847447158267D-01,7.3864234232170D-02,5.5532251360371D-01,
     > 7.3460813453490D-02,5.9186840343222D-01,7.2656175235500D-02,
     > 6.2791253689849D-01,7.1454714482610D-02,6.6325808487552D-01,
     > 6.9862990173320D-02,6.9771181125973D-01,6.7889718091910D-02,
     > 7.3108637193333D-01,6.5545559066180D-02,7.6319671900011D-01,
     > 6.2843787993900D-02,7.9387484478393D-01,5.9797577974870D-02/
      DATA             ((SYST(IS,IA),IS=1,2),IA=449,460)/
     > 8.2293728002029D-01,5.6428463918250D-02,8.5025266912033D-01,
     > 5.2739723763830D-02,8.7563910939874D-01,4.8802517410530D-02,
     > 8.9895990801325D-01,4.4490374567250D-02,9.2022975422536D-01,
     > 4.0172324368590D-02,9.3877903172577D-01,3.5258261911020D-02,
     > 9.5598754636848D-01,3.1066242940220D-02,9.6864609020677D-01,
     > 2.6329620936360D-02,9.8207312074062D-01,2.2831730375060D-02,
     > 9.8847852226738D-01,2.0716186813260D-02,9.9661056712718D-01,
     > 1.0827682155930D-02,9.9884898177306D-01,7.5418025361000D-03/
*----
*  Order =  44
*----
      DATA             ((SYST(IS,IA),IS=1,2),IA=461,490)/
     > 6.1252206042000D-04,3.3140554230300D-03,4.1720931122600D-03,
     > 9.2651070517900D-03,9.0669071405200D-03,1.3576563197170D-02,
     > 1.7615803993250D-02,1.8912297449420D-02,2.7955617624090D-02,
     > 2.3395928365090D-02,4.0412230027940D-02,2.8425424168950D-02,
     > 5.6055103315820D-02,3.2836252919920D-02,7.2703919502150D-02,
     > 3.7296156992010D-02,9.2688130969150D-02,4.0885547703750D-02,
     > 1.1367090301189D-01,4.4885591782210D-02,1.3736990564741D-01,
     > 4.8609514192960D-02,1.6232287944645D-01,5.2059853714740D-02,
     > 1.8930735363830D-01,5.5313358960350D-02,2.1764165334825D-01,
     > 5.8256109292030D-02,2.4748186983961D-01,6.0928266329370D-02,
     > 2.7853682871557D-01,6.3289657305750D-02,3.1071115303397D-01,
     > 6.5338210957320D-02,3.4382360369818D-01,6.7060623782030D-02,
     > 3.7771529185760D-01,6.8449071717460D-02,4.1221599144869D-01,
     > 6.9496491802960D-02,4.4715404915482D-01,7.0197685473830D-02,
     > 4.8235538151795D-01,7.0549157789350D-02,5.1764461848205D-01,
     > 7.0549157789350D-02,5.5284595084511D-01,7.0197685473840D-02,
     > 5.8778400855113D-01,6.9496491802960D-02,6.2228470823467D-01,
     > 6.8449071711000D-02,6.5617639467039D-01,6.7060623933340D-02,
     > 6.8928886090713D-01,6.5338209334940D-02,7.2146309410466D-01,
     > 6.3289667630390D-02,7.5251844435846D-01,6.0928210763750D-02/
      DATA             ((SYST(IS,IA),IS=1,2),IA=491,504)/
     > 7.8235733192687D-01,5.8256286581880D-02,8.1069533877281D-01,
     > 5.5312566740350D-02,8.3767098068236D-01,5.2061152990920D-02,
     > 8.6264199947756D-01,4.8603281013420D-02,8.8630854032991D-01,
     > 4.4892027979270D-02,9.0734171525029D-01,4.0819832600500D-02,
     > 9.2725855295616D-01,3.6991471526480D-02,9.4398125724790D-01,
     > 3.2053582499500D-02,9.5956693163156D-01,2.8799109630940D-02,
     > 9.7203704644518D-01,2.3034882925340D-02,9.8242235595345D-01,
     > 1.7253492479830D-02,9.9087335981979D-01,1.4306222180000D-02,
     > 9.9587701930960D-01,9.6801811169800D-03,9.9937229793867D-01,
     > 3.3961120793100D-03/
*----
*  Start processing
*----
      PI=XDRCST('Pi',' ')
      NBPT=(ORDRE*ORDRE)/2
      IF(3*NBPT .NE. NBANGL) CALL XABORT(NAMSBR//
     >': Number of quadrature points is invalid')
      ILEVEL=1
      JLEVEL=0
      NLEVEL=ORDRE/2
      KLEVEL=(NLEVEL*(NLEVEL-1))-2
      IPOINT=0
*      write(6,*) KLEVEL
      DO IPT=1,NBPT
        JLEVEL = JLEVEL + 1
        ALPHA =(PI/DBLE(2*NLEVEL))*(DBLE(2*JLEVEL-1)/DTWO)
*        write(6,*) ALPHA,KLEVEL+ILEVEL,XI,SYST(2,KLEVEL+ILEVEL)
        XI=SYST(1,KLEVEL+ILEVEL)
        ROTXI=SQRT(DONE-XI**2)
        COSA=COS(ALPHA)
        SINA=SIN(ALPHA)
        WGTINV=DBLE(48*NLEVEL)/SYST(2,KLEVEL+ILEVEL)
        DO IROT=1,3
*----
*  \xi direction (3)
*  \mu direction (2)
*  \eta direction (1)
*----
          IDIR1=MOD(IROT-1,3)+1
          IDIR2=MOD(IROT,3)+1
          IDIR3=MOD(IROT+1,3)+1
          IPOINT=IPOINT+1
          DDENWT(1,IPOINT)=DQUAD(1)*WGTINV
          DANGLT(IDIR1,1,IPOINT)=COSA*ROTXI
          DANGLT(IDIR2,1,IPOINT)=SINA*ROTXI
          DANGLT(IDIR3,1,IPOINT)=XI
          DDENWT(2,IPOINT)=DQUAD(2)*WGTINV
          DANGLT(1,2,IPOINT)=-DANGLT(1,1,IPOINT)
          DANGLT(2,2,IPOINT)=DANGLT(2,1,IPOINT)
          DANGLT(3,2,IPOINT)=DANGLT(3,1,IPOINT)
          DDENWT(3,IPOINT)=DQUAD(3)*WGTINV
          DANGLT(1,3,IPOINT)=DANGLT(1,1,IPOINT)
          DANGLT(2,3,IPOINT)=-DANGLT(2,1,IPOINT)
          DANGLT(3,3,IPOINT)=DANGLT(3,1,IPOINT)
          DDENWT(4,IPOINT)=DQUAD(4)*WGTINV
          DANGLT(1,4,IPOINT)=-DANGLT(1,1,IPOINT)
          DANGLT(2,4,IPOINT)=-DANGLT(2,1,IPOINT)
          DANGLT(3,4,IPOINT)=DANGLT(3,1,IPOINT)
        ENDDO
        IF(JLEVEL .EQ. NLEVEL) THEN
          ILEVEL = ILEVEL + 1
          JLEVEL = 0
        ENDIF
      ENDDO
      RETURN
      END
