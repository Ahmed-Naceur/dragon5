#!/bin/sh
# --- MANUAL ENERGY GROUP SELECTION 
# execute: ./W_debug

cd /home/ahnac/Compiler/Njoy2012_EPM_cepxsr
./install
cd /home/ahnac/Compiler/dragon5_ev2148_2/Dragon/data/electron_proc


echo "**********************************************************"
echo "           Construt NJOY files                            "
echo "**********************************************************"

System=`uname -s`

FolderNjoy=/home/ahnac/Compiler/dragon5_ev2148_2/Dragon/data/electron_proc/njoy/test/;
FolderDragonData=/home/ahnac/Compiler/dragon5_ev2148_2/Dragon/data;
cd $FolderNjoy;
rm tape*


Ne=$1;
Ng=$2;
Legendre=$3;
Nmat=2;
Emin=$4; Emax=$5; 

Title="W-20MeV-300Groups:CEPXSR";
FileExtension="W300g_20MeV_nc.txt"
FileInPut="in_${FileExtension}";
FileOutPut="out_${FileExtension}";
FileGendf="gendf_${FileExtension}";
FileMatxs="matxs_${FileExtension}";

HOME=/home/ahnac/Compiler/;
echo "--------------------------------------------------";
echo "       1- Access ENDF-B.VIII data                 ";
echo "--------------------------------------------------";

ln -s /home/ahnac/Compiler/evaluations/ENDF-B-VIII.0/electrons/EEDL2017.ALL.txt tape30

echo "--------------------------------------------------";
echo "       2- Access CEPXS-BFP data                   ";
echo "--------------------------------------------------";

ln -s /home/ahnac/Compiler/Njoy2012_EPM_cepxsr/TAPE9 tape40
ln -s /home/ahnac/Compiler/Njoy2012_EPM_cepxsr/STPOWER_TAPE9_1984.txt tape38

echo "--------------------------------------------------";
echo "       3- NJOY is operating                       ";
echo "--------------------------------------------------";



weight_function_option=2;
iprint=1;

cat>./input <<EOF
cepxsr
30 0 33 40 
7400 1 0 2 10 1
$Title/
300 / # of groups boundaries
1.0000000547034879e+03
1.0336195733414934e+03
1.0683693639511201e+03
1.1042874257299056e+03
1.1414130353900468e+03
1.1797867901078265e+03
1.2194506519169776e+03
1.2604479935945307e+03
1.3028236460893227e+03
1.3466239475450276e+03
1.3918967939713194e+03
1.4386916916185740e+03
1.4870598111133833e+03
1.5370540434140798e+03
1.5887290576474574e+03
1.6421413608899377e+03
1.6973493599585464e+03
1.7544134252792758e+03
1.8133959569026691e+03
1.8743614527388169e+03
1.9373765790863813e+03
2.0025102435327724e+03
2.0698336703051930e+03
2.1394204781549483e+03
2.2113467608601907e+03
2.2856911704351242e+03
2.3625350031366665e+03
2.4419622883626105e+03
2.5240598805384988e+03
2.6089175540936938e+03
2.6966281016304935e+03
2.7872874353936472e+03
2.8809946921512287e+03
2.9778523416015500e+03
3.0779662984246688e+03
3.1814460381010068e+03
3.2884047166237395e+03
3.3989592942358553e+03
3.5132306633271966e+03
3.6313437806313382e+03
3.7534278038668565e+03
3.8796162329724189e+03
4.0100470560901222e+03
4.1448629004567266e+03
4.2842111883677706e+03
4.4282442983851391e+03
4.5771197319643339e+03
4.7310002856836885e+03
4.8900542292638341e+03
5.0544554895721044e+03
5.2243838408130693e+03
5.4000251011131891e+03
5.5815713357145486e+03
5.7692210669998663e+03
5.9631794915784393e+03
6.1636587046704199e+03
6.3708779320347771e+03
6.5850637696945654e+03
6.8064504317216432e+03
7.0352800063517929e+03
7.2718027207103065e+03
7.5162772144375181e+03
7.7689708225134940e+03
8.0301598675911554e+03
8.3001299621574924e+03
8.5791763208533049e+03
8.8676040832929622e+03
9.1657286477372299e+03
9.4738760159839962e+03
9.7923831498540718e+03
1.0121598339661862e+04
1.0461881585073848e+04
1.0813604988771345e+04
1.1177153163348020e+04
1.1552923651887084e+04
1.1941327362678117e+04
1.2342789018548845e+04
1.2757747621303234e+04
1.3186656931773771e+04
1.3629985966012878e+04
1.4088219508166027e+04
1.4561858640587415e+04
1.5051421291777859e+04
1.5557442802744114e+04
1.6080476512398904e+04
1.6621094362641826e+04
1.7179887523782775e+04
1.7757467040991813e+04
1.8354464502482352e+04
1.8971532730158381e+04
1.9609346493480836e+04
2.0268603247333875e+04
2.0950023894697866e+04
2.1654353574963030e+04
2.2382362478745834e+04
2.3134846690099110e+04
2.3912629057036887e+04
2.4716560091325817e+04
2.5547518898527181e+04
2.6406414139306448e+04
2.7294185023061586e+04
2.8211802334956706e+04
2.9160269497484046e+04
3.0140623667715180e+04
3.1153936871441270e+04
3.2201317175442577e+04
3.3283909899169094e+04
3.4402898867157305e+04
3.5559507703552574e+04
3.6755001170152797e+04
3.7990686549436360e+04
3.9267915074086904e+04
4.0588083404577972e+04
4.1952635156433354e+04
4.3363062478833217e+04
4.4820907686292120e+04
4.6327764945193396e+04
4.7885282017023842e+04
4.9495162060215266e+04
5.1159165492562983e+04
5.2879111916257937e+04
5.4656882107637514e+04
5.6494420073830764e+04
5.8393735178547061e+04
6.0356904339332780e+04
6.2386074298698614e+04
6.4483463971601165e+04
6.6651366871845710e+04
6.8892153620063415e+04
7.1208274536005575e+04
7.3602262317989539e+04
7.6076734812426286e+04
7.8634397876458151e+04
8.1278048336837175e+04
8.4010577048279314e+04
8.6834972054639276e+04
8.9754321856362285e+04
9.2771818787786189e+04
9.5890762507986727e+04
9.9114563608983380e+04
0.10244674734525129e+06     
0.10589095748861770e+06     
0.10945096031275794e+06     
0.11313064871164850e+06     
0.11693404645648030e+06     
0.12086531259568735e+06     
0.12492874600290244e+06     
0.12912879007781261e+06     
0.13347003760505532e+06     
0.13795723577646837e+06     
0.14259529138218524e+06     
0.14738927617625275e+06     
0.15234443242263807e+06     
0.15746617862768994e+06     
0.16276011546532224e+06     
0.16823203190139963e+06     
0.17388791152402192e+06     
0.17973393908662952e+06     
0.18577650727108502e+06     
0.19202222367812635e+06     
0.19847791805283535e+06     
0.20515064975302347e+06     
0.21204771546870060e+06     
0.21917665720106908e+06     
0.22654527050976730e+06     
0.23416161303738189e+06     
0.24203401332054983e+06     
0.25017107989728538e+06     
0.25858171072049124e+06     
0.26727510288794726e+06     
0.27626076269941652e+06     
0.28554851605186660e+06     
0.29514851918417345e+06     
0.30507126978305643e+06     
0.31532761846238982e+06     
0.32592878062844344e+06     
0.33688634874402656e+06     
0.34821230500494665e+06     
0.35991903444264439e+06     
0.37201933846733287e+06     
0.38452644886645121e+06     
0.39745404227373843e+06     
0.41081625512475134e+06     
0.42462769911517934e+06     
0.43890347717886058e+06     
0.45365920000297116e+06     
0.46891100309844680e+06     
0.48467556444430437e+06     
0.50097012272515629e+06     
0.51781249618186198e+06     
0.53522110209592877e+06     
0.55321497692896893e+06     
0.57181379713923575e+06     
0.59103790069800144e+06     
0.61090830932930484e+06     
0.63144675149738938e+06     
0.65267568616696703e+06     
0.67461832736229133e+06     
0.69729866955189412e+06     
0.72074151388674501e+06     
0.74497249532052545e+06     
0.77001811064167269e+06     
0.79590574744784814e+06     
0.82266371409451255e+06     
0.85032127065035901e+06     
0.87890866089345121e+06     
0.90845714538305777e+06     
0.93899903564334475e+06     
0.97056772949630765e+06     
1.0031977475825795e+06     
1.0369247711100513e+06     
1.0717856808715818e+06     
1.1078185975744650e+06     
1.1450629235257541e+06     
1.1835593857190265e+06     
1.2233500803697037e+06     
1.2644785189476293e+06     
1.3069896757572381e+06     
1.3509300371173483e+06     
1.3963476521943543e+06     
1.4432921855444079e+06     
1.4918149714220401e+06     
1.5419690699146147e+06     
1.5938093249639942e+06     
1.6473924243388656e+06     
1.7027769616233077e+06     
1.7600235002893834e+06     
1.8191946399238221e+06     
1.8803550846812109e+06     
1.9435717140385491e+06     
2.0089136559285361e+06     
2.0764523623315663e+06     
2.1462616874090892e+06     
2.2184179682637759e+06     
2.2930001084148026e+06     
2.3700896640795350e+06     
2.4497709333559574e+06     
2.5321310484033761e+06     
2.6172600707221911e+06     
2.7052510896369273e+06     
2.7962003240902202e+06     
2.8902072278590625e+06     
2.9873745983083744e+06     
3.0878086888008114e+06     
3.1916193248857416e+06     
3.2989200243944334e+06     
3.4098281215727919e+06     
3.5244648953873718e+06     
3.6429557021449828e+06     
3.7654301125708969e+06     
3.8920220534955603e+06     
4.0228699543047455e+06     
4.1581168983132866e+06     
4.2979107792279230e+06     
4.4424044628703516e+06     
4.5917559543373327e+06     
4.7461285707806278e+06     
4.9056911199957298e+06     
5.0706180850146430e+06     
5.2410898149046021e+06     
5.4172927219813340e+06     
5.5994194856525477e+06     
5.7876692631145348e+06     
5.9822479071322947e+06     
6.1833681911413167e+06     
6.3912500419171794e+06     
6.6061207800673882e+06     
6.8282153686084301e+06     
7.0577766698998721e+06     
7.2950557112164596e+06     
7.5403119592486165e+06     
7.7938136038315271e+06     
8.0558378512130400e+06     
8.3266712271811176e+06     
8.6066098903822539e+06     
8.8959599561735452e+06     
9.1950378313624679e+06     
9.5041705602004853e+06     
9.8236961820087618e+06     
10.153964100827100e+06     
10.495335467490291e+06     
10.848183574549678e+06     
11.212894264471808e+06     
11.589866351560515e+06     
11.979512058063815e+06     
12.382257464942525e+06     
12.798542977793470e+06     
13.228823808436850e+06     
13.673570472694289e+06     
14.133269304901985e+06     
14.608422989721523e+06     
15.099551111829912e+06     
15.607190724089936e+06     
16.131896934822123e+06     
16.674243514820507e+06     
17.234823524775976e+06     
17.814249963793269e+06     
18.413156439710828e+06     
19.032197861956472e+06     
19.672051157696519e+06     
20.333416012061530e+06 /
-1 0/
0/
matxsr
0  0 35  0  0  0  0  0  0 33/ 
1 'W-20MeV-300Groups:CEPXSR'/                     
1 1 1 1 1 /                   
'test'/
'b'/
300/
'bscat'/
1
1
'w' 7400 7400
stop
EOF

/home/ahnac/Compiler/Njoy2012_EPM_cepxsr/Linux/xnjoy<input

echo "--------------------------------------------------";
echo "      4- Saving output and plot files             ";
echo "--------------------------------------------------";

mv input  $FileInPut
mv output $FileOutPut
mv tape33 $FileGendf
mv tape35 $FileMatxs

echo "--------------------------------------------------";
echo "      5- Input file removed                       ";
echo "--------------------------------------------------";

#ls -t | head -n4;

#echo "**********************************************************"
#echo "           Dragon .access file construction               "
#echo "**********************************************************"

#file_access_dragon='/home/ahnac/Compiler/dragon5_ev2148_2/Dragon/data/electron.access' 
#sed  -i "/#--- CEPXSR-NJOY/a  ln -s \$1/data/cepxs-dragon/$fmac_file_name_ascii ." $file_access_dragon 

echo "--------------------------------------------------";
echo "      Execute DRAGON                              ";
echo "--------------------------------------------------";

cd /home/ahnac/Compiler/dragon5_ev2148_2/Dragon
./rdragon electron.x2m
