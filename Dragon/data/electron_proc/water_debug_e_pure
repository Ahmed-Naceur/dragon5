#!/bin/sh
# --- MANUAL ENERGY GROUP SELECTION 
# execute: ./water_debug_e_pure
# e.g.: ./water_debug_e_pure

cd /home/ahnac/Compiler/Njoy2012_EPM_cepxsr
./install
cd /home/ahnac/Compiler/dragon5_ev2148_2/Dragon/data/electron_proc


echo "**********************************************************"
echo "           Construt NJOY files                            "
echo "**********************************************************"

System=`uname -s`

FolderNjoy=/home/ahnac/Compiler/dragon5_ev2148_2/Dragon/data/electron_proc/njoy/test/;
FolderDragonData=/home/ahnac/Compiler/dragon5_ev2148_2/Dragon/data;
cd $FolderNjoy;
rm tape*


Ne=$1;
Ng=$2;
Legendre=$3;
Nmat=2;
Emin=$4; Emax=$5; 

Title="test:non-coupled";
FileExtension="water_300g_10MeV_nc.txt"
FileInPut="in_${FileExtension}";
FileOutPut="out_${FileExtension}";
FileGendf="gendf_${FileExtension}";
FileMatxs="matxs_${FileExtension}";

HOME=/home/ahnac/Compiler/;
echo "--------------------------------------------------";
echo "       1- Access ENDF-B.VIII data                 ";
echo "--------------------------------------------------";

ln -s /home/ahnac/Compiler/evaluations/ENDF-B-VIII.0/electrons/EEDL2017.ALL.txt tape30

echo "--------------------------------------------------";
echo "       2- Access CEPXS-BFP data                   ";
echo "--------------------------------------------------";

ln -s /home/ahnac/Compiler/Njoy2012_EPM_cepxsr/TAPE9 tape40
ln -s /home/ahnac/Compiler/Njoy2012_EPM_cepxsr/STPOWER_TAPE9_1984.txt tape38

echo "--------------------------------------------------";
echo "       3- NJOY is operating                       ";
echo "--------------------------------------------------";



weight_function_option=2;
iprint=1;

cat>./input <<EOF
cepxsr
30 0 33 40 
100 1 0 2 9 1
$Title/
300 / # of groups boundaries
1.0000000547034603e+03
1.0312301841113784e+03
1.0634356344487786e+03
1.0966468651128361e+03
1.1308952867515906e+03
1.1662132909716304e+03
1.2026342809735543e+03
1.2401927031441813e+03
1.2789240796353895e+03
1.3188650419603965e+03
1.3600533656392552e+03
1.4025280059263340e+03
1.4463291346535692e+03
1.4914981782243395e+03
1.5380778567938903e+03
1.5861122246733706e+03
1.6356467119956930e+03
1.6867281676826219e+03
1.7394049037537311e+03
1.7937267410191350e+03
1.8497450561992101e+03
1.9075128305158710e+03
1.9670846998013584e+03
2.0285170061719311e+03
2.0918678513153323e+03
2.1571971514424350e+03
2.2245666939550279e+03
2.2940401958833467e+03
2.3656833641486205e+03
2.4395639577076168e+03
2.5157518516379773e+03
2.5943191032249402e+03
2.6753400201119646e+03
2.7588912305797032e+03
2.8450517560197988e+03
2.9339030856720466e+03
3.0255292536956065e+03
3.1200169186471603e+03
3.2174554454411802e+03
3.3179369898698311e+03
3.4215565857624339e+03
3.5284122348669352e+03
3.6386049995383858e+03
3.7522390983220888e+03
3.8694220045218273e+03
3.9902645478463849e+03
4.1148810192305025e+03
4.2433892789294110e+03
4.3759108679891591e+03
4.5125711231981868e+03
4.6534992956288419e+03
4.7988286728809669e+03
4.9486967051431676e+03
5.1032451351909931e+03
5.2626201324449725e+03
5.4269724312153043e+03
5.5964574732639445e+03
5.7712355548189221e+03
5.9514719781799388e+03
6.1373372080586255e+03
6.3290070328013244e+03
6.5266627306468832e+03
6.7304912411766966e+03
6.9406853421191596e+03
7.1574438316757425e+03
7.3809717165411320e+03
7.6114804057952727e+03
7.8491879108506680e+03
8.0943190516440805e+03
8.3471056692675984e+03
8.6077868452402312e+03
8.8766091276273485e+03
9.1538267642218944e+03
9.4397019430078472e+03
9.7345050401334097e+03
1.0038514875628417e+04
1.0352018977107844e+04
1.0675313851710798e+04
1.1008705266532203e+04
1.1352508537812405e+04
1.1707048829158200e+04
1.2072661459077351e+04
1.2449692218117436e+04
1.2838497695908989e+04
1.3239445618422246e+04
1.3652915195756451e+04
1.4079297480790670e+04
1.4518995739035322e+04
1.4972425830034213e+04
1.5440016600677803e+04
1.5922210290799713e+04
1.6419462951440030e+04
1.6932244876171076e+04
1.7461041045893477e+04
1.8006351587523325e+04
1.8568692247004161e+04
1.9148594877091227e+04
1.9746607940369202e+04
2.0363297027979326e+04
2.0999245394546420e+04
2.1655054509811707e+04
2.2331344627493237e+04
2.3028755371911885e+04
2.3747946342937750e+04
2.4489597739829092e+04
2.5254411004553882e+04
2.6043109485202314e+04
2.6856439120117818e+04
2.7695169143393539e+04
2.8560092812401582e+04
2.9452028158043084e+04
3.0371818758428690e+04
3.1320334536721159e+04
3.2298472583894712e+04
3.3307158007189253e+04
3.4347344805061936e+04
3.5420016769463533e+04
3.6526188416293091e+04
3.7666905944910734e+04
3.8843248227616180e+04
4.0056327830028868e+04
4.1307292063334590e+04
4.2597324069393983e+04
4.3927643939739081e+04
4.5299509869516273e+04
4.6714219347467022e+04
4.8173110383071906e+04
4.9677562772018409e+04
5.1228999401189572e+04
5.2828887594407459e+04
5.4478740500204501e+04
5.6180118522935016e+04
5.7934630798580557e+04
5.9743936716644894e+04
6.1609747489577878e+04
6.3533827771212706e+04
6.5517997325747118e+04
6.7564132748847150e+04
6.9674169242501111e+04
7.1850102445302530e+04
7.4093990319893069e+04
7.6407955099350472e+04
7.8794185294362537e+04
8.1254937763085289e+04
8.3792539845643166e+04
8.6409391565289886e+04
8.9107967898311893e+04
9.1890821114821095e+04
9.4760583192650891e+04
9.7719968306638566e+04
0.10077177539564813e+06     
0.10391889080976179e+06     
0.10716429104014333e+06     
0.11051104553415575e+06     
0.11396231959839513e+06     
0.11752137739238676e+06     
0.12119158501577473e+06     
0.12497641369192486e+06     
0.12887944305095198e+06     
0.13290436451527649e+06     
0.13705498479091235e+06     
0.14133522946778859e+06     
0.14574914673250883e+06     
0.15030091119706143e+06     
0.15499482784710017e+06     
0.15983533611353051e+06     
0.16482701407125205e+06     
0.16997458276902813e+06     
0.17528291069457783e+06     
0.18075701837911337e+06     
0.18640208314567791e+06     
0.19222344400577432e+06     
0.19822660670891654e+06     
0.20441724894987889e+06     
0.21080122573856855e+06     
0.21738457493759977e+06     
0.22417352297280729e+06     
0.23117449072209975e+06     
0.23839409958822286e+06     
0.24583917776117559e+06     
0.25351676667620254e+06     
0.26143412767347024e+06     
0.26959874886572582e+06     
0.27801835222043375e+06     
0.28670090086308853e+06     
0.29565460660861076e+06     
0.30488793772794953e+06     
0.31440962695723729e+06     
0.32422867975707081e+06     
0.33435438282973151e+06     
0.34479631290239882e+06     
0.35556434578466506e+06     
0.36666866570891704e+06     
0.37811977496241989e+06     
0.38992850382021071e+06     
0.40210602078819935e+06     
0.41466384316616139e+06     
0.42761384794061508e+06     
0.44096828301788443e+06     
0.45473977880797189e+06     
0.46894136017019716e+06     
0.48358645873189987e+06     
0.49868892559185668e+06     
0.51426304442042770e+06     
0.53032354496882250e+06     
0.54688561700026195e+06     
0.56396492465621195e+06     
0.58157762127127666e+06     
0.59974036465076275e+06     
0.61847033282536390e+06     
0.63778524029786587e+06     
0.65770335479723852e+06     
0.67824351455596021e+06     
0.69942514612691542e+06     
0.72126828275671573e+06     
0.74379358333282286e+06     
0.76702235192239188e+06     
0.79097655792131583e+06     
0.81567885683252683e+06     
0.84115261169320665e+06     
0.86742191517117184e+06     
0.89451161235133136e+06     
0.92244732423376863e+06     
0.95125547196567151e+06     
0.98096330183002833e+06     
1.0115989110147248e+06     
1.0431912741864120e+06     
1.0757702708942807e+06     
1.1093667138296583e+06     
1.1440123779681575e+06     
1.1797400306219368e+06     
1.2165834624304976e+06     
1.2545775193193285e+06     
1.2937581354566206e+06     
1.3341623672392262e+06     
1.3758284283400037e+06     
1.4187957258496946e+06     
1.4631048975475165e+06     
1.5087978503357213e+06     
1.5559177998744700e+06     
1.6045093114545088e+06     
1.6546183421463050e+06     
1.7062922842655053e+06     
1.7595800101958259e+06     
1.8145319186117674e+06     
1.8711999821448713e+06     
1.9296377965385987e+06     
1.9899006313383230e+06     
2.0520454821643779e+06     
2.1161311246175982e+06     
2.1822181698683387e+06     
2.2503691219815440e+06     
2.3206484370320886e+06     
2.3931225840662966e+06     
2.4678601079672968e+06     
2.5449316942836715e+06     
2.6244102360827108e+06     
2.7063709028915062e+06     
2.7908912117910782e+06     
2.8780511007307870e+06     
2.9679330041323588e+06     
3.0606219308550378e+06     
3.1562055445955974e+06     
3.2547742467992569e+06     
3.3564212621599130e+06     
3.4612427267905570e+06     
3.5693377791472676e+06     
3.6808086537927642e+06     
3.7957607780882174e+06     
3.9143028719047486e+06     
4.0365470504489389e+06     
4.1626089302995881e+06     
4.2926077387560140e+06     
4.4266664266013196e+06     
4.5649117843872649e+06     
4.7074745623507317e+06     
4.8544895940751953e+06     
5.0060959240141640e+06     
5.1624369389971818e+06     
5.3236605038427927e+06     
5.4899191012067039e+06     
5.6613699757974336e+06     
5.8381752830958256e+06     
6.0205022427191004e+06     
6.2085232965744757e+06     
6.4024162719519531e+06     
6.6023645497105088e+06     
6.8085572377167640e+06     
7.0211893497001627e+06     
7.2404619896938209e+06     
7.4665825422354928e+06     
7.6997648685085300e+06     
7.9402295086083452e+06     
8.1882038901256973e+06     
8.4439225432440459e+06     
8.7076273225544298e+06     
8.9795676357976522e+06     
9.2600006797501084e+06     
9.5491916834763657e+06     
9.8474141591785465e+06     
10.154950160879777e+06 /
-1 0/
800
-1 0/
0/
matxsr
0  0 35  0  0  0  0  0  0 33/ 
1 'test'/                     
1 1 1 2 1 /                   
'test'/
'b'/
300/
'bscat'/
1
1
'h' 100 100
'o' 800 800  
stop
EOF

/home/ahnac/Compiler/Njoy2012_EPM_cepxsr/Linux/xnjoy<input

echo "--------------------------------------------------";
echo "      4- Saving output and plot files             ";
echo "--------------------------------------------------";

mv input  $FileInPut
mv output $FileOutPut
mv tape33 $FileGendf
mv tape35 $FileMatxs

echo "--------------------------------------------------";
echo "      5- Input file removed                       ";
echo "--------------------------------------------------";

#ls -t | head -n4;

echo "--------------------------------------------------";
echo "      Execute DRAGON                              ";
echo "--------------------------------------------------";

# cd /home/ahnac/Compiler/dragon5_ev2148_2/Dragon
# ./rdragon electron.x2m
