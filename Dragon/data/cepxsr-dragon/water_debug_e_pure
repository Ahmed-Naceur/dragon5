#!/bin/sh
# --- MANUAL ENERGY GROUP SELECTION 
# execute: ./water_debug_e_pure
# e.g.: ./water_debug_e_pure

#cd /home/ahnac/Compiler/Njoy2012_EPM_cepxsr
#./install
#cd /home/ahnac/Compiler/dragon5_ev2148_2/Dragon/data/cepxsr-dragon


echo "**********************************************************"
echo "           Construt NJOY files                            "
echo "**********************************************************"

System=`uname -s`

FolderNjoy=/home/ahnac/Compiler/dragon5_ev2148_2/Dragon/data/cepxsr-dragon/njoy/test/;
FolderDragonData=/home/ahnac/Compiler/dragon5_ev2148_2/Dragon/data;
cd $FolderNjoy;
rm tape*


Ne=$1;
Ng=$2;
Legendre=$3;
Nmat=2;
Emin=$4; Emax=$5; 

Title="test:non-coupled";
FileExtension="test_nc.txt"
FileInPut="in_${FileExtension}";
FileOutPut="out_${FileExtension}";
FileGendf="gendf_${FileExtension}";
FileMatxs="matxs_${FileExtension}";

HOME=/home/ahnac/Compiler/;
echo "--------------------------------------------------";
echo "       1- Access ENDF-B.VIII data                 ";
echo "--------------------------------------------------";

ln -s /home/ahnac/Compiler/evaluations/ENDF-B-VIII.0/electrons/EEDL2017.ALL.txt tape30

echo "--------------------------------------------------";
echo "       2- Access CEPXS-BFP data                   ";
echo "--------------------------------------------------";

ln -s /home/ahnac/Compiler/Njoy2012_EPM_cepxsr/TAPE9 tape40
ln -s /home/ahnac/Compiler/Njoy2012_EPM_cepxsr/STPOWER_TAPE9_1984.txt tape38

echo "--------------------------------------------------";
echo "       3- NJOY is operating                       ";
echo "--------------------------------------------------";



weight_function_option=2;
iprint=1;

cat>./input <<EOF
cepxsr
30 0 33 40 
100 1 0 2 2 1
$Title/
80 / # of groups, energy boundaries follow:
 1.000000000000000e+03
 1.105950000000000e+03
 1.223140000000000e+03
 1.352730000000000e+03
 1.496060000000000e+03
 1.654580000000000e+03
 1.829890000000000e+03
 2.023770000000000e+03
 2.238200000000000e+03
 2.475350000000000e+03
 2.737620000000000e+03
 3.027690000000000e+03
 3.348490000000000e+03
 3.703270000000000e+03
 4.095650000000000e+03
 4.529610000000000e+03
 5.009540000000000e+03
 5.540330000000000e+03
 6.127350000000000e+03
 6.776570000000000e+03
 7.494580000000000e+03
 8.288670000000000e+03
 9.166889999999999e+03
 1.013820000000000e+04
 1.121240000000000e+04
 1.240040000000000e+04
 1.371420000000000e+04
 1.516730000000000e+04
 1.677440000000000e+04
 1.855170000000000e+04
 2.051730000000000e+04
 2.269130000000000e+04
 2.509550000000000e+04
 2.775450000000000e+04
 3.069520000000000e+04
 3.394750000000000e+04
 3.754440000000000e+04
 4.152240000000000e+04
 4.592190000000000e+04
 5.078760000000000e+04
 5.616880000000000e+04
 6.212010000000000e+04
 6.870210000000001e+04
 7.598139999999999e+04
 8.403200000000000e+04
 9.293550000000000e+04
 1.027830000000000e+05
 1.136730000000000e+05
 1.257170000000000e+05
 1.390370000000000e+05
 1.537690000000000e+05
 1.700620000000000e+05
 1.880800000000000e+05
 2.080080000000000e+05
 2.300480000000000e+05
 2.544230000000000e+05
 2.813800000000000e+05
 3.111930000000000e+05
 3.441660000000000e+05
 3.806320000000000e+05
 4.209620000000000e+05
 4.655640000000000e+05
 5.148930000000000e+05
 5.694490000000000e+05
 6.297840000000000e+05
 6.965130000000000e+05
 7.703120000000000e+05
 8.519300000000000e+05
 9.421960000000000e+05
 1.042030000000000e+06
 1.152430000000000e+06
 1.274540000000000e+06
 1.409580000000000e+06
 1.558940000000000e+06
 1.724110000000000e+06
 1.906790000000000e+06
 2.108820000000000e+06
 2.332260000000000e+06
 2.579380000000000e+06
 2.852680000000000e+06
 3.154930000000000e+06 /
-1 0/
800
-1 0/
0/
matxsr
0  0 35  0  0  0  0  0  0 33/ 
1 'test'/                     
1 1 1 2 1 /                   
'test'/
'b'/
80/
'bscat'/
1
1
'h' 100 100
'o' 800 800  
stop
--
--
--
--
-- DEBUGGED WATER
-- cepxsr
-- 30 0 33 40 
-- 100 1 0 2 2 1
-- $Title/
-- 2 / # of groups, electron energy boundaries follow:
-- 1.00000E+03 2.00033E+06 3.99967E+06 /
-- -1 0/
-- 800
-- -1 0/
-- 0/
-- matxsr
-- 0  0 35  0  0  0  0  0  0 33/ 
-- 1 'test'/                     
-- 1 1 1 2 1 /                   
-- 'test'/
-- 'b'/
-- 2/
-- 'bscat'/
-- 1
-- 1
-- 'h' 100 100
-- 'o' 800 800  
--
--
--
--
-- DEBUGGED TUNGSTEN
-- cepxsr
-- 30 0 33 40 
-- 7400 1 0 2 2 1
-- $Title/
-- 2 / # of groups, electron energy boundaries follow:
-- 1.00000E+03 2.00033E+06 3.99967E+06 /
-- -1 0/
-- 0/
-- matxsr
-- 0  0 35  0  0  0  0  0  0 33/ 
-- 1 'test'/                     
-- 1 1 1 1 1 /                   
-- 'test'/
-- 'b'/
-- 2/
-- 'bscat'/
-- 1
-- 1
-- 'w' 7400 7400
EOF

/home/ahnac/Compiler/Njoy2012_EPM_cepxsr/Linux/xnjoy<input

echo "--------------------------------------------------";
echo "      4- Saving output and plot files             ";
echo "--------------------------------------------------";

mv input  $FileInPut
mv output $FileOutPut
mv tape33 $FileGendf
mv tape35 $FileMatxs

echo "--------------------------------------------------";
echo "      5- Input file removed                       ";
echo "--------------------------------------------------";

#ls -t | head -n4;

#echo "**********************************************************"
#echo "           Dragon .access file construction               "
#echo "**********************************************************"


#cd $FolderDragonData;

#file_access_dragon='/home/ahnac/Compiler/dragon5_ev2148_2/Dragon/data/water_1D.access' 

#sed  -i "/#--- CEPXSR-NJOY/a  ln -s \$1/data/cepxsr-dragon/njoy/$FileMatxs _cepxsr_P${Legendre}_${Ne}Ne_${Ng}Ng" $file_access_dragon 

