***********************************************************
* Input file :  test_channBWR.x2m                         *
* AUTHOR: Augusto Hernandez Solis (KTH)                   *
* auhs@kth.se                                             *
*                                                         *
* Test of a BWR fuel assembly with real power conditions  *
*                                                         *
* The aim is to test the THM module of DONJON             *
***********************************************************
 
LINKED_LIST GEOM GEOM2 MATEX FMAP THM ;
MODULE GEO: USPLIT: RESINI: THM: END: ;
PROCEDURE assertS ;

GEOM := GEO: :: CAR3D 1 1 27
          EDIT 5
          X- VOID  X+ VOID
          Y- VOID  Y+ VOID
          Z- VOID  Z+ VOID
          MESHX  0.000 15.375 

          MESHY  0.000 15.375 

          MESHZ  0.000  14.720  29.440  44.160  58.880  73.600 
 88.320  103.040  117.760  132.480  147.200  161.920 
 176.640  191.360  206.080  220.800  235.520  250.240 
 264.960  279.680  294.400  309.120  323.840  338.560 
 353.280  368.000  382.720  397.440 

MIX

PLANE 1  1
PLANE 2  2
PLANE 3  SAME 2
PLANE 4  SAME 2
PLANE 5  SAME 2
PLANE 6  SAME 2
PLANE 7  SAME 2
PLANE 8  SAME 2
PLANE 9  SAME 2
PLANE 10  SAME 2
PLANE 11  SAME 2
PLANE 12  SAME 2
PLANE 13  SAME 2
PLANE 14  SAME 2
PLANE 15  SAME 2
PLANE 16  SAME 2
PLANE 17  SAME 2
PLANE 18  SAME 2
PLANE 19  SAME 2
PLANE 20  SAME 2
PLANE 21  SAME 2
PLANE 22  SAME 2
PLANE 23  SAME 2
PLANE 24  SAME 2
PLANE 25  SAME 2
PLANE 26  SAME 2
PLANE 27  SAME 1
         ;

GEOM2 MATEX := USPLIT: GEOM :: EDIT 5 NGRP 2 MAXR 27

NREFL 1  RMIX 1 

NFUEL 1  FMIX 2 

;

FMAP MATEX := RESINI: MATEX ::
::: GEO: CAR3D 1 1 27
          EDIT 5
          X- VOID  X+ VOID
          Y- VOID  Y+ VOID
          Z- VOID  Z+ VOID
          MESHX  0.000 15.375 

          MESHY  0.000 15.375 

          MESHZ  0.000  14.720  29.440  44.160  58.880  73.600 
 88.320  103.040  117.760  132.480  147.200  161.920 
 176.640  191.360  206.080  220.800  235.520  250.240 
 264.960  279.680  294.400  309.120  323.840  338.560 
 353.280  368.000  382.720  397.440 

MIX

PLANE 1  0
PLANE 2  2
PLANE 3  SAME 2
PLANE 4  SAME 2
PLANE 5  SAME 2
PLANE 6  SAME 2
PLANE 7  SAME 2
PLANE 8  SAME 2
PLANE 9  SAME 2
PLANE 10  SAME 2
PLANE 11  SAME 2
PLANE 12  SAME 2
PLANE 13  SAME 2
PLANE 14  SAME 2
PLANE 15  SAME 2
PLANE 16  SAME 2
PLANE 17  SAME 2
PLANE 18  SAME 2
PLANE 19  SAME 2
PLANE 20  SAME 2
PLANE 21  SAME 2
PLANE 22  SAME 2
PLANE 23  SAME 2
PLANE 24  SAME 2
PLANE 25  SAME 2
PLANE 26  SAME 2
PLANE 27  SAME 1
         ;

NXNAME '01'
NYNAME  'A'

NCOMB 1
B-ZONE 1

BTYPE INST-BURN 
INST-BVAL BUND 
 1600.000  7000.000  9800.000  10800.000  11300.000 
 11400.000  11300.000  10900.000  10900.000  10800.000 
 10600.000  10300.000  10300.000  10100.000  10400.000 
 10200.000  10400.000  10200.000  9900.000  9400.000 
 8900.000  8100.000  6700.000  4900.000  1700.000 

BUNDLE-POW BUND 
 43.236  211.550  287.214  305.744  311.920 
 307.288  301.111  290.302  288.758  282.581 
 274.861  264.051  259.419  250.154  231.624 
 222.359  219.271  210.006  197.653  183.755 
 168.313  146.695  117.356  78.752  20.074 

ADD-PARAM PNAME 'C-BORE' PARKEY 'ppmBore' GLOBAL
ADD-PARAM PNAME 'T-FUEL' PARKEY 'TF' GLOBAL 
ADD-PARAM PNAME 'T-COOL' PARKEY 'TCA' GLOBAL
ADD-PARAM PNAME 'D-COOL' PARKEY 'DCA' GLOBAL
         ;
INTEGER iter := 1 ;

WHILE iter 10 < DO

 IF iter 1 = THEN

  THM FMAP := THM: FMAP ::
  EDIT 10
  CRITFL 1.80E+6 (* W/m^2 *)
  ASSMB 91 0
  RADIUS 0.0041 0.0044 0.0050 0.0 (* m *)
  RODMESH 5 10
  SPEED 1.5939
  SAHA
  INLET 7090000.0000 (* Pa *) 550.150 (* K *) 
  RELAX 0.5
  SET-PARAM 'T-COOL' 500.0
  SET-PARAM 'T-FUEL' 1000.0
  SET-PARAM 'D-COOL' 0.75
         ;
 ELSE

  THM FMAP := THM: THM FMAP :: EDIT 5 ;

 ENDIF ;

 EVALUATE iter := iter 1 + ;

ENDWHILE ;

assertS THM :: "MIN-T-FUEL" 1 583.3722 ;
assertS THM :: "MAX-T-FUEL" 1 928.3032 ;
ECHO "test test_channBWR completed" ;

END: ;
